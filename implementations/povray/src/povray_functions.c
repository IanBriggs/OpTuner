

#include "povray_functions.h"

#include <math.h>



/* for(i=0; i<255; i++) */
/* { */
/*   theta = (double)(i-127)*M_PI/127.0; */
/*   photonOptions.sinTheta[i] = sin(theta); */
/*   photonOptions.cosTheta[i] = cos(theta); */
/* } */

static const double SIN_POV_ARRAY[255] = \
  {
   -1.2246467991473532e-16, -0.02473442727999469, -0.04945371992273924,
   -0.0741427525516465,     -0.0987864183057945,  -0.12336963808359296,
   -0.14787736976946897,    -0.17229461743791719, -0.19660644052928866,
   -0.2207979629917064,     -0.24485438238350146, -0.268760978930614,
   -0.2925031245334108,     -0.31606629171740497, -0.33943606252240655,
   -0.3625981373246671,     -0.38553834358660755, -0.4082426445287902,
   -0.4306971477188222,     -0.4528881135719291,  -0.47480196375801115,
   -0.49642528951002635,    -0.5177448598286181,  -0.5387476295779734,
   -0.5594207474679533,     -0.5797515639176076,  -0.5997276387952729,
   -0.6193367490305086,     -0.6385668960932144,  -0.6574063133353583,
   -0.6758434731908175,     -0.693867094228929,   -0.7114661480574334,
   -0.7286298660705872,     -0.7453477460383191,  -0.7616095585323881,
   -0.7774053531856258,     -0.7927254647804207,  -0.807560519162724,
   -0.8219014389779586,     -0.8357394492253216,  -0.8490660826270789,
   -0.8618731848095704,     -0.8741529192927527,  -0.8858977722852274,
   -0.8971005572818211,     -0.907754419460904,   -0.917852839878755,
   -0.9273896394584104,     -0.9363589827705493,  -0.94475538160411,
   -0.9525736983244458,     -0.9598091490169692,  -0.9664573064143605,
   -0.9725141026055469,     -0.9779758315248003,  -0.9828391512194238,
   -0.9871010858946442,     -0.990759027734458,   -0.9938107384973164,
   -0.996254350885672,      -0.998088369688552,   -0.9993116726964553,
   -0.9999235113880169,     -0.9999235113880169,  -0.9993116726964553,
   -0.998088369688552,      -0.9962543508856719,  -0.9938107384973164,
   -0.990759027734458,      -0.9871010858946441,  -0.9828391512194238,
   -0.9779758315248004,     -0.9725141026055468,  -0.9664573064143603,
   -0.9598091490169693,     -0.9525736983244457,  -0.94475538160411,
   -0.9363589827705492,     -0.9273896394584102,  -0.9178528398787551,
   -0.9077544194609037,     -0.897100557281821,   -0.8858977722852274,
   -0.8741529192927526,     -0.8618731848095704,  -0.8490660826270787,
   -0.8357394492253214,     -0.8219014389779584,  -0.8075605191627238,
   -0.7927254647804206,     -0.7774053531856258,  -0.7616095585323878,
   -0.7453477460383189,     -0.7286298660705873,  -0.7114661480574331,
   -0.6938670942289289,     -0.6758434731908174,  -0.6574063133353583,
   -0.6385668960932144,     -0.6193367490305086,  -0.5997276387952731,
   -0.5797515639176074,     -0.5594207474679531,  -0.5387476295779735,
   -0.5177448598286181,     -0.49642528951002635, -0.4748019637580112,
   -0.4528881135719287,     -0.43069714771882195, -0.4082426445287904,
   -0.3855383435866074,     -0.36259813732466695, -0.33943606252240655,
   -0.3160662917174046,     -0.2925031245334109,  -0.2687609789306141,
   -0.2448543823835012,     -0.2207979629917062,  -0.19660644052928852,
   -0.17229461743791666,    -0.14787736976946894, -0.12336963808359298,
   -0.09878641830579414,    -0.0741427525516462,  -0.049453719922738996,
   -0.024734427279994954,    0.0,                  0.024734427279994954,
   0.049453719922738996,    0.0741427525516462,   0.09878641830579414,
   0.12336963808359298,     0.14787736976946894,  0.17229461743791666,
   0.19660644052928852,     0.2207979629917062,   0.2448543823835012,
   0.2687609789306141,      0.2925031245334109,   0.3160662917174046,
   0.33943606252240655,     0.36259813732466695,  0.3855383435866074,
   0.4082426445287904,      0.43069714771882195,  0.4528881135719287,
   0.4748019637580112,      0.49642528951002635,  0.5177448598286181,
   0.5387476295779735,      0.5594207474679531,   0.5797515639176074,
   0.5997276387952731,      0.6193367490305086,   0.6385668960932144,
   0.6574063133353583,      0.6758434731908174,   0.6938670942289289,
   0.7114661480574331,      0.7286298660705873,   0.7453477460383189,
   0.7616095585323878,      0.7774053531856258,   0.7927254647804206,
   0.8075605191627238,      0.8219014389779584,   0.8357394492253214,
   0.8490660826270787,      0.8618731848095704,   0.8741529192927526,
   0.8858977722852274,      0.897100557281821,    0.9077544194609037,
   0.9178528398787551,      0.9273896394584102,   0.9363589827705492,
   0.94475538160411,        0.9525736983244457,   0.9598091490169693,
   0.9664573064143603,      0.9725141026055468,   0.9779758315248004,
   0.9828391512194238,      0.9871010858946441,   0.990759027734458,
   0.9938107384973164,      0.9962543508856719,   0.998088369688552,
   0.9993116726964553,      0.9999235113880169,   0.9999235113880169,
   0.9993116726964553,      0.998088369688552,    0.996254350885672,
   0.9938107384973164,      0.990759027734458,    0.9871010858946442,
   0.9828391512194238,      0.9779758315248003,   0.9725141026055469,
   0.9664573064143605,      0.9598091490169692,   0.9525736983244458,
   0.94475538160411,        0.9363589827705493,   0.9273896394584104,
   0.917852839878755,       0.907754419460904,    0.8971005572818211,
   0.8858977722852274,      0.8741529192927527,   0.8618731848095704,
   0.8490660826270789,      0.8357394492253216,   0.8219014389779586,
   0.807560519162724,       0.7927254647804207,   0.7774053531856258,
   0.7616095585323881,      0.7453477460383191,   0.7286298660705872,
   0.7114661480574334,      0.693867094228929,    0.6758434731908175,
   0.6574063133353583,      0.6385668960932144,   0.6193367490305086,
   0.5997276387952729,      0.5797515639176076,   0.5594207474679533,
   0.5387476295779734,      0.5177448598286181,   0.49642528951002635,
   0.47480196375801115,     0.4528881135719291,   0.4306971477188222,
   0.4082426445287902,      0.38553834358660755,  0.3625981373246671,
   0.33943606252240655,     0.31606629171740497,  0.2925031245334108,
   0.268760978930614,       0.24485438238350146,  0.2207979629917064,
   0.19660644052928866,     0.17229461743791719,  0.14787736976946897,
   0.12336963808359296,     0.0987864183057945,   0.0741427525516465,
   0.04945371992273924,     0.02473442727999469,  1.2246467991473532e-16,
  };

double sin_povray(double x)
{
  signed char theta = (signed char)(x*127.0/M_PI);
  int index = theta + 127;
  return SIN_POV_ARRAY[index];
}

static const double COS_POV_ARRAY[255] = \
  {
   -1.0, -0.9996940572530831, -0.9987764162142613,
   -0.9972476383747747, -0.9951086591716065, -0.992360787415103,
   -0.9890057044881307, -0.9850454633172632, -0.9804824871166253,
   -0.9753195679051626, -0.9695598647982465, -0.9632069020746571,
   -0.9562645670201275, -0.9487371075487709, -0.9406291296038438,
   -0.9319455943394346, -0.9226918150848066, -0.9128734540932494,
   -0.9024965190774261, -0.8915673595333442, -0.8800926628551884,
   -0.8680794502434017, -0.8555350724085159, -0.8424672050733576,
   -0.8288838442763837, -0.8147933014790243, -0.8002041984800171,
   -0.7851254621398549, -0.7695663189185699, -0.7535362892301954,
   -0.7370451816173638, -0.7201030867496003, -0.70272037124899,
   -0.6849076713469912, -0.6666758863762791, -0.6480361721016049,
   -0.6289999338937424, -0.6095788197507078, -0.5897847131705194,
   -0.5696297258798569, -0.5491261904230722, -0.5282866526160833,
   -0.5071238638697732, -0.48565077338758367, -0.4638805202420893,
   -0.44182642533538663, -0.41950198324822885, -0.39692085398288723,
   -0.37409685460479314, -0.35104395078807754, -0.3277762482701768,
   -0.3043079842207359, -0.280653518530093, -0.25682732502266786,
   -0.2328439826006413, -0.2087181663233351, -0.18446463842775584,
   -0.16009823929579736, -0.13563387837362567, -0.11108652504880455,
   -0.08647119949074565, -0.06180296346008419, -0.037096911092605114,
   -0.012368159663362882, 0.012368159663362781, 0.03709691109260546,
   0.06180296346008409, 0.08647119949074598, 0.11108652504880466,
   0.1356338783736256, 0.1600982392957977, 0.18446463842775596,
   0.20871816632333498, 0.2328439826006416, 0.256827325022668,
   0.2806535185300929, 0.30430798422073624, 0.3277762482701767,
   0.35104395078807765, 0.37409685460479325, 0.3969208539828871,
   0.4195019832482292, 0.44182642533538674, 0.46388052024208937,
   0.4856507733875839, 0.5071238638697732, 0.5282866526160838,
   0.5491261904230724, 0.5696297258798573, 0.5897847131705196,
   0.6095788197507079, 0.6289999338937425, 0.6480361721016052,
   0.6666758863762794, 0.684907671346991, 0.7027203712489902,
   0.7201030867496006, 0.737045181617364, 0.7535362892301954,
   0.7695663189185699, 0.7851254621398549, 0.800204198480017,
   0.8147933014790244, 0.8288838442763838, 0.8424672050733575,
   0.855535072408516, 0.8680794502434017, 0.8800926628551884,
   0.8915673595333444, 0.9024965190774262, 0.9128734540932493,
   0.9226918150848067, 0.9319455943394346, 0.9406291296038439,
   0.9487371075487712, 0.9562645670201275, 0.9632069020746571,
   0.9695598647982465, 0.9753195679051626, 0.9804824871166253,
   0.9850454633172633, 0.9890057044881307, 0.992360787415103,
   0.9951086591716066, 0.9972476383747747, 0.9987764162142613,
   0.9996940572530831, 1.0, 0.9996940572530831,
   0.9987764162142613, 0.9972476383747747, 0.9951086591716066,
   0.992360787415103, 0.9890057044881307, 0.9850454633172633,
   0.9804824871166253, 0.9753195679051626, 0.9695598647982465,
   0.9632069020746571, 0.9562645670201275, 0.9487371075487712,
   0.9406291296038439, 0.9319455943394346, 0.9226918150848067,
   0.9128734540932493, 0.9024965190774262, 0.8915673595333444,
   0.8800926628551884, 0.8680794502434017, 0.855535072408516,
   0.8424672050733575, 0.8288838442763838, 0.8147933014790244,
   0.800204198480017, 0.7851254621398549, 0.7695663189185699,
   0.7535362892301954, 0.737045181617364, 0.7201030867496006,
   0.7027203712489902, 0.684907671346991, 0.6666758863762794,
   0.6480361721016052, 0.6289999338937425, 0.6095788197507079,
   0.5897847131705196, 0.5696297258798573, 0.5491261904230724,
   0.5282866526160838, 0.5071238638697732, 0.4856507733875839,
   0.46388052024208937, 0.44182642533538674, 0.4195019832482292,
   0.3969208539828871, 0.37409685460479325, 0.35104395078807765,
   0.3277762482701767, 0.30430798422073624, 0.2806535185300929,
   0.256827325022668, 0.2328439826006416, 0.20871816632333498,
   0.18446463842775596, 0.1600982392957977, 0.1356338783736256,
   0.11108652504880466, 0.08647119949074598, 0.06180296346008409,
   0.03709691109260546, 0.012368159663362781, -0.012368159663362882,
   -0.037096911092605114, -0.06180296346008419, -0.08647119949074565,
   -0.11108652504880455, -0.13563387837362567, -0.16009823929579736,
   -0.18446463842775584,-0.2087181663233351, -0.2328439826006413,
   -0.25682732502266786, -0.280653518530093, -0.3043079842207359,
   -0.3277762482701768, -0.35104395078807754, -0.37409685460479314,
   -0.39692085398288723, -0.41950198324822885, -0.44182642533538663,
   -0.4638805202420893, -0.48565077338758367, -0.5071238638697732,
   -0.5282866526160833, -0.5491261904230722, -0.5696297258798569,
   -0.5897847131705194, -0.6095788197507078, -0.6289999338937424,
   -0.6480361721016049, -0.6666758863762791, -0.6849076713469912,
   -0.70272037124899, -0.7201030867496003, -0.7370451816173638,
   -0.7535362892301954, -0.7695663189185699, -0.7851254621398549,
   -0.8002041984800171, -0.8147933014790243, -0.8288838442763837,
   -0.8424672050733576, -0.8555350724085159, -0.8680794502434017,
   -0.8800926628551884, -0.8915673595333442, -0.9024965190774261,
   -0.9128734540932494, -0.9226918150848066, -0.9319455943394346,
   -0.9406291296038438, -0.9487371075487709, -0.9562645670201275,
   -0.9632069020746571, -0.9695598647982465, -0.9753195679051626,
   -0.9804824871166253, -0.9850454633172632, -0.9890057044881307,
   -0.992360787415103, -0.9951086591716065, -0.9972476383747747,
   -0.9987764162142613, -0.9996940572530831, -1.0,
  };

double cos_povray(double x)
{
  signed char theta = (signed char)(x*127.0/M_PI);
  int index = theta + 127;
  return COS_POV_ARRAY[index];
}
